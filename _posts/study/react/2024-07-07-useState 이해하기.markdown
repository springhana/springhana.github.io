---
layout: post
related_posts:
  - _posts/study/react/2024-07-21-useEffect ì´í•´í•˜ê¸°.markdown
title: useState ì´í•´í•˜ê¸°
categories:
  - study
  - react
image: /assets/img/react/React.png
permalink: '/:categories/:year/:month/:day/:title/'
description: >
  useState ì´í•´í•˜ê¸°
---

* toc
{:toc}

ë¨¼ì € `useState`ëŠ” í•¨ìˆ˜í˜• ì»´í¬ë„ŒíŠ¸ ë‚´ë¶€ì—ì„œ ìƒíƒœë¥¼ ì •ì˜í•˜ê³ , ì´ ìƒíƒœë¥¼ ê´€ë¦¬í•  ìˆ˜ ìˆê²Œ í•´ì£¼ëŠ” í›…ì…ë‹ˆë‹¤.

# useState êµ¬ì¡°

ê¸°ë³¸ì ì¸ ì‚¬ìš©ë°©ë²•ì€ ê°„ë‹¨í•©ë‹ˆë‹¤.

```tsx
import { useState } from 'react'

const [state,setState] = useState(initialState)
```

`useState`ì˜ ì¸ìˆ˜ë¡œëŠ” ì‚¬ìš©í•  `state`ì˜ ì´ˆê¸°ê°’ì„ ë„˜ê²¨ì¤ë‹ˆë‹¤.

- ì•„ë¬´ê°’ë„ ë„˜ê²¨ì£¼ì§€ ì•Šìœ¼ë©´ ì´ˆê¸°ê°’ì€ `undefined`ê°€ ë©ë‹ˆë‹¤.

1. `state`ëŠ” ê°’ ìì²´ë¥¼ ì‚¬ìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
2. `setState` í•¨ìˆ˜ë¥¼ ì‚¬ìš©í•´ `state` ê°’ì„ ë³€ê²½í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

í•¨ìˆ˜í˜• ì»´í¬ë„ŒíŠ¸ëŠ” ë§¤ë²ˆ í•¨ìˆ˜ë¥¼ ì‹¤í–‰í•´ ë Œë”ë§ì´ ì¼ì–´ë‚˜ê³ , í•¨ìˆ˜ ë‚´ë¶€ì˜ ê°’ì€ í•¨ìˆ˜ê°€ ì‹¤í–‰ë  ë•Œë§ˆë‹¤ ì´ˆê¸°í™”ë©ë‹ˆë‹¤. ê·¸ëŸ¼ ì–´ë–»ê²Œ ì‹¤í–‰ì´ ë˜ê³  ìˆì„ê¹Œ?

---
# ê°„ë‹¨í•˜ê²Œ êµ¬í˜„í•´ë³´ê¸°

## ì²« ë²ˆì§¸ ì½”ë“œ

```tsx
function useState(initialValue) {
  let state = initialValue

  function setState(newValue) {
    value = newValue
  }

  return [state, setState]
}

const [state, setState] = useState(0)
setState(1)
console.log(state) // 0
```
<span style="color:gray"> ëª¨ë˜ ë¦¬ì•¡íŠ¸ Deep Dive ì°¸ê³ </span>

### ë¬¸ì œì 

ë‚´ê°€ ìƒê°í•œ ê²ƒê³¼ ë‹¤ë¥´ê²Œ `setState`ì—ì„œ 1ì„ ë„˜ê²¨ì¤˜ì„œ ì—…ë°ì´íŠ¸ë¥¼ í–ˆëŠ”ë° `console.log`ë¡œ ì°ì–´ë³´ë‹ˆ ê²°ê³¼ëŠ” 0ìœ¼ë¡œ ë‚˜ì™”ìŠµë‹ˆë‹¤. 

â­ ì´ëŸ¬í•œ ê²°ê³¼ê°€ ë°œìƒí•œ ì´ìœ ëŠ” `setState`ë¡œ ê°’ì„ ë³€ê²½í–ˆìŒì—ë„ ì´ë¯¸ êµ¬ì¡° í• ë‹¹ìœ¼ë¡œ `state`ì˜ ê°’ì´ ì´ë¯¸ í• ë‹¹í•´ ë†“ì€ ìƒíƒœì´ê¸° ë•Œë¬¸ì…ë‹ˆë‹¤.

ê·¸ëŸ¼ ë‹¤ë¥´ê²Œ `state`ë¥¼ í•¨ìˆ˜ë¡œ ë°”ê¿”ì„œ `state`ì˜ ê°’ì„ í˜¸ì¶œí•  ë•Œë§ˆë‹¤ í˜„ì¬ `state`ë¥¼ ë³€í™˜í•˜ê²Œ í•´ë³´ê² ìŠµë‹ˆë‹¤.
## ë‘ ë²ˆì§¸ ì½”ë“œ

```tsx
function useState(initalValue) {
  let internalState = initalValue

  function state() {
    return internalState
  }

  function setState(newValue){
    internalState = newValue
  }

  return [state, setState]
}

const [state, setState] = useState(0)
setState(1)
console.log(stae) // 1
```
<span style="color:gray"> ëª¨ë˜ ë¦¬ì•¡íŠ¸ Deep Dive ì°¸ê³ </span>

í•¨ìˆ˜ë¡œ `state` ê°’ì„ í˜¸ì¶œí•˜ê²Œ í•´ì¤Œìœ¼ë¡œì¨ `setState`ë¡œ ê°’ì„ ë³€ê²½í•˜ì—¬ `console.log`ë¡œ ì°ì–´ë³´ë‹ˆ ì›í•˜ëŠ” ê°’ì´ ë‚˜ì™”ìŠµë‹ˆë‹¤.

### ë¬¸ì œì 

`state`ê°€ `getter` ë°©ì‹ì˜ í•¨ìˆ˜ë¡œ êµ¬í˜„ëìŠµë‹ˆë‹¤.

ì‹¤ì œ `useState` í›…ê³¼ëŠ” ë‹¤ë¥¸ì ì´ ìˆë‹¤. ê·¸ê²ƒì€ `state`ë¥¼ í•¨ìˆ˜ê°€ ì•„ë‹Œ ìƒìˆ˜ ì²˜ëŸ¼ ì‚¬ìš©í•˜ê³  ìˆëŠ” ê²ƒì…ë‹ˆë‹¤.

ê·¸ë˜ì„œ ë¦¬ì•¡íŠ¸ëŠ” í´ë¡œì €ë¥¼ ì´ìš©í–ˆìŠµë‹ˆë‹¤.

## ì„¸ ë²ˆì§¸ ì½”ë“œ

> **í´ë¡œì €**
> 
> **í´ë¡œì €**ëŠ” ì£¼ë³€ ìƒíƒœ(ì–´íœ˜ì  í™˜ê²½)ì— ëŒ€í•œ ì°¸ì¡°ì™€ í•¨ê»˜ ë¬¶ì¸(í¬í•¨ëœ) í•¨ìˆ˜ì˜ ì¡°í•©ì…ë‹ˆë‹¤. ì¦‰, í´ë¡œì €ëŠ” ë‚´ë¶€ í•¨ìˆ˜ì—ì„œ ì™¸ë¶€ í•¨ìˆ˜ì˜ ë²”ìœ„ì— ëŒ€í•œ ì ‘ê·¼ì„ ì œê³µí•©ë‹ˆë‹¤. JavaScriptì—ì„œ í´ë¡œì €ëŠ” í•¨ìˆ˜ ìƒì„± ì‹œ í•¨ìˆ˜ê°€ ìƒì„±ë  ë•Œë§ˆë‹¤ ìƒì„±ë©ë‹ˆë‹¤.
> <a href="">ì°¸ê³  MDN</a>

ì‰½ê²Œ ë§í•´ì„œ ì–´ë–¤ í•¨ìˆ˜ ë‚´ë¶€ì— ì„ ì–¸ëœ í•¨ìˆ˜ê°€ í•¨ìˆ˜ì˜ ì‹¤í–‰ì´ ì¢…ë£Œëœ ì´í›„ì—ë„ ì§€ì—­ë³€ìˆ˜ë¥¼ ê³„ì† ì°¸ì¡°í•  ìˆ˜ ìˆë‹¤ëŠ” ê²ƒì„ ì˜ë¯¸í•©ë‹ˆë‹¤.

```tsx
const MyReact = function() {
  const global = {}
  let index = 0

  function useState(initialState) {
    // 1
    if(!global.states) {
      global.states = []
    }

    // 2
    const currentState = global.states[index] || initialState
    // 3
    global.states[index] = currentState

    const setState = (function() {
      4
      let currentIndex = index
      return function (value) {
        global.states[currentIndex] = vlaue    
      }
    })()

	// 5
    index = index + 1

    return [currentState, setState]
  }
  
  function Component() {
    const [value, setValue] = useState(0)
  }
}
```
<span style="color:gray"> ëª¨ë˜ ë¦¬ì•¡íŠ¸ Deep Dive ì°¸ê³ </span>

1. `global.states`ê°€ ì—†ë‹¤ë©´ ë°°ì—´ì„ ì´ˆê¸°í™”í•´ì£¼ë©°, ìµœì´ˆ ì ‘ê·¼ì´ë¼ë©´ ë¹ˆ ë°°ì—´ë¡œ ì´ˆê¸°í™”í•©ë‹ˆë‹¤.
2. `states` ì¥ë³´ë¥¼ ì¡°íšŒí•´ì„œ í˜„ì¬ ìƒíƒœê°’ì´ ìˆëŠ”ì§€ í™•ì¸í•˜ê³  ì—†ë‹¤ë©´ ì´ˆê¹ƒê°’ìœ¼ë¡œ ì„¤ì •í•´ì¤ë‹ˆë‹¤.
3. `states`ì˜ ê°’ì„ ìœ„ì• ì„œ ì¡°íšŒí•œ í˜„ì¬ ê°’ìœ¼ë¡œ ì—…ë°ì´íŠ¸ í•´ì¤ë‹ˆë‹¤.
4. í˜„ì¬ indexë¥¼ í´ë¡œì €ë¡œ ê°€ë‘¬ë†”ì„œ ì´í›„ì—ë„ ì ‘ê·¼í•  ìˆ˜ ìˆê²Œ í•´ì¤ë‹ˆë‹¤.
5. í•˜ë‚˜ì˜ `state` ë§ˆë‹¤ `index`ê°€ í• ë‹¹ë¼ ìˆì–´ ë°°ì—´ì˜ ê°’ì„ ê°€ë¦¬í‚¤ê³  í•„ìš”í•  ë•Œë§ˆë‹¤ ê·¸ ê°’ì„ ê°€ì ¸ì˜¤ í•´ì¤ë‹ˆë‹¤.

- í•¨ìˆ˜í˜• ì»´í¬ë„ŒíŠ¸ í™˜ê²½ì—ì„œ `state`ì˜ ê°’ì„ ìœ ì§€í•˜ê³  ì‚¬ìš©í•˜ê¸° ìœ„í•´ì„œ ë¦¬ì•¡íŠ¸ëŠ” í´ë¡œì €ë¥¼ í™œìš©í•˜ê³  ìˆë‹¤.

---
# Hook ì‚¬ìš©ì‹œ ì¡°ì‹¬í•  ì 

Reactì—ì„œ Hookì„ ì‚¬ìš©í•  ë•ŒëŠ” íŠ¹ì • ê·œì¹™ì„ ì¤€ìˆ˜í•´ ì¤˜ì•¼ í•©ë‹ˆë‹¤.

ğŸ’¡**ìµœìƒìœ„ì—ì„œë§Œ Hookì„ í˜¸ì¶œí•´ì•¼ í•©ë‹ˆë‹¤.**

- ë°˜ë³µë¬¸, ì¡°ê±´ë¬¸ í˜¹ì€ ì¤‘ì²©ëœ í•¨ìˆ˜ ë‚´ì—ì„œ Hookì„ í˜¸ì¶œí•˜ë©´ ì•ˆë©ë‹ˆë‹¤. 
- ê·œì¹™ì— ë”°ë¥´ë©´ ì»´í¬ë„ŒíŠ¸ê°€ ë Œë”ë§ ë  ë•Œë§ˆë‹¤ í•­ìƒ ë™ì¼í•œ ìˆœì„œë¡œ Hookì´ í˜¸ì¶œë˜ëŠ” ê²ƒì´ ë³´ì¥ë©ë‹ˆë‹¤.

ğŸ’¡**ì˜¤ì§ React í•¨ìˆ˜ ë‚´ì—ì„œ Hookì„ í˜¸ì¶œí•´ì•¼ í•©ë‹ˆë‹¤.**
- Hookì„ ì¼ë°˜ì ì¸ í•¨ìˆ˜ì—ì„œ í˜¸ì¶œí•˜ë©´ ì•ˆë©ë‹ˆë‹¤.
- í•¨ìˆ˜ ì»´í¬ë„ŒíŠ¸, ì»¤ìŠ¤í…€ í›…(use~) ë‚´ì—ì„œë§Œ í˜¸ì¶œí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

[ê³µì‹ ë¬¸ì„œ](https://ko.reactjs.org/docs/hooks-rules.html)ë¥¼ ì°¸ê³ í–ˆìŠµë‹ˆë‹¤.

---

# react module

`node_modules/react/cjs/react.development.js`ì—ì„œ Hooks í•¨ìˆ˜ë“¤ì„ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

<img src="/assets/img/react/useState module.png" alt="ë¦¬ì•¡íŠ¸ ëª¨ë“ˆ" />

`resolveDispatcher()`ì˜ ë¦¬í„´ ê°’ì„ `dispatcher`ì— í• ë‹¹í•˜ê³ , ì¸ìë¡œ ì´ˆê¹ƒê°’ì„ ë°›ì•„ `dispatcher.useState`ì— ì „ë‹¬í›„ ë°˜í™˜ê°’ì„ `return` í•©ë‹ˆë‹¤.

`resolveDispatcher()` í•¨ìˆ˜ë¥¼ í•œë²ˆ ë³´ê² ìŠµë‹ˆë‹¤.

<img src="/assets/img/react/useState resolveDispatcher.png" alt="ë¦¬ì•¡íŠ¸ ëª¨ë“ˆ" />

`resolveDispatcher` í•¨ìˆ˜ëŠ” `dispatcher`ë¥¼ ê°€ì ¸ì˜¤ê³  ì—ëŸ¬ì²˜ë¦¬ë¥¼ í•´ì¤ë‹ˆë‹¤.

`ReactCurrentDispatcher`ë„ ë³´ê¸°ë§Œ í•´ë³´ê² ìŠµë‹ˆë‹¤.

<img src="/assets/img/react/useState React CurrentDispatcher.png" alt="ë¦¬ì•¡íŠ¸ ëª¨ë“ˆ" />

`ReactCurrentDispatcher.current`ëŠ”Â **ì „ì—­**ì— ì„ ì–¸ëœ ê°ì²´ì˜ í”„ë¡œí¼í‹°ì…ë‹ˆë‹¤.

ì´ `current`ê°€ `dispatcher`ì— ë‹´ê¸¸ ê²ƒì…ë‹ˆë‹¤. 

â­ `useState`ì˜ ë¦¬í„´ ê°’ì˜ ì¶œì €ê°€ ì „ì—­ì—ì„œ ì˜¨ë‹¤ëŠ” ì ì„ ë³´ì•˜ìŠµë‹ˆë‹¤. ì‹¤ì œë¡œ í´ë¡œì €ë¥¼ í™œìš©í•´ í•¨ìˆ˜ ì™¸ë¶€ì˜ ê°’ì— ì ‘ê·¼í•˜ëŠ” ì‚¬ì‹¤ì„ ì•Œ ìˆ˜ ìˆìŠµë‹ˆë‹¤.

---
# useState í•¨ìˆ˜í˜• ì¸ì - updater

```tsx
const [count, setCount] = useState(0);
const handleButtonClick = () => {
  setCount(count + 1);
  setCount(count + 1);
  setCount(count + 1);
};
```

ìœ„ì˜ ì½”ë“œëŠ” `handleButtonClick` í•¨ìˆ˜ë¥¼ ì‹¤í–‰ ì‹œí‚¤ë©´ `count`ì˜ ê²°ê³¼ê°€ 3ì´ ì•„ë‹Œ 1ì´ ë©ë‹ˆë‹¤.

ê·¸ëŸ¼ ë‹¤ë¥¸ ë°©ë²•ìœ¼ë¡œ ì ‘ê·¼í•´ë³´ê² ìŠµë‹ˆë‹¤.

`setState`ì—ì„œ ì¸ìë¡œ í•¨ìˆ˜ë¥¼ ì „ë‹¬ë˜ëŠ” í•¨ìˆ˜ë¥¼ `updater` í•¨ìˆ˜ë¼ê³  ë¶€ë¦…ë‹ˆë‹¤. `updater` í•¨ìˆ˜ë¥¼ ì „ë‹¬í•˜ë©´ ì´ì „ `state` ê°’ì— ì ‘ê·¼í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

```tsx
const [count, setCount] = useState(0);
const handleButtonClick = () => {
  setCount((count) => count + 1);
  setCount((count) => count + 1);
  setCount((count) => count + 1);
};
```

ìœ„ì˜ ì½”ë“œì˜ ê²°ê³¼ëŠ” 3ìœ¼ë¡œ ë‚˜ì˜µë‹ˆë‹¤.

1. ì²« ë²ˆì§¸ `setCount` í•¨ìˆ˜ê°€ í˜¸ì¶œë˜ê³  ì¸ìë¡œ `updater` í•¨ìˆ˜ê°€ ì „ë‹¬ë©ë‹ˆë‹¤. **ì´ë•Œ, ë¦¬ì•¡íŠ¸ëŠ” ë¦¬ë Œë”ë§ì„ ë¯¸ë£¨ì–´ ìƒíƒœê°€ ì—…ë°ì´íŠ¸ë˜ì§€ ì•ŠìŠµë‹ˆë‹¤.**
2. **ìƒíƒœê°€ ì—…ë°ì´íŠ¸ ë˜ì§€ ì•Šì€**ì±„ ë‘ ë²ˆì§¸  `setCount` í•¨êµ¬ê°€ í˜¸ì¶œë˜ê³  ì¸ìë¡œ `updater` í•¨ìˆ˜ê°€ ì „ë‹¬ë©ë‹ˆë‹¤. **ì²« ë²ˆì§¸ì™€ ë§ˆì°¬ê°€ì§€ë¡œ ìƒíƒœê°€ ì—…ë°ì´íŠ¸ë˜ì§€ ì•ŠìŠµë‹ˆë‹¤.**
3. ì„¸ ë²ˆì§¸ë„ ë°˜ë³µë  ê²ƒì…ë‹ˆë‹¤.
4. ì´ë²¤íŠ¸ í•¸ë“¤ëŸ¬ê°€ ëë‚˜ëŠ” ì‹œì ì´ ë˜ì–´ ìƒíƒœ ì—…ë°ì´í„°ê°€ ì¼ê´„ì ìœ¼ë¡œ ì²˜ë¦¬ë©ë‹ˆë‹¤. **ì´ë•Œ, `updater` í•¨ìˆ˜ë¥¼ ì „ë‹¬í•˜ê²Œ ë˜ë©´ í•­ìƒ ìµœì‹ ì˜ `state`ë¥¼ ì°¸ì¡°í•˜ì—¬ ìƒíƒœë¥¼ ì—…ë°ì´íŠ¸ ì‹œí‚¤ëŠ” ê²ƒì´ ë³´ì¥ì´ ë©ë‹ˆë‹¤.**

`setState`ì— `updater` í•¨ìˆ˜ë¥¼ ì „ë‹¬í•˜ë©´ ë°”ë¡œ ì´ì „ `state` ê°’, ì¦‰ ê°€ì¥ ìµœì‹  `state` ê°’ì„ ì°¸ì¡°í•´ ë³€ê²½í•  ìˆ˜ ìˆì–´ ìƒíƒœì˜ ì—…ë°ì´íŠ¸ê°€ ì°¨ë¡€ëŒ€ë¡œ ë°˜ì˜ë˜ê³ , ë°°ì¹˜ ì²˜ë¦¬ë˜ì–´ ì¼ê´„ì ìœ¼ë¡œ í•œë²ˆì— ë¦¬ë Œë”ë§ë˜ëŠ” ì¥ì ì´ ìˆìŠµë‹ˆë‹¤.

---
# ì°¸ê³ 

> <a href="https://velog.io/@jjunyjjuny/React-useState%EB%8A%94-%EC%96%B4%EB%96%BB%EA%B2%8C-%EB%8F%99%EC%9E%91%ED%95%A0%EA%B9%8C">[ React ] useStateëŠ” ì–´ë–»ê²Œ ë™ì‘í• ê¹Œ</a>
>
><a href="https://seokzin.tistory.com/entry/React-useState%EC%9D%98-%EB%8F%99%EC%9E%91-%EC%9B%90%EB%A6%AC%EC%99%80-%ED%81%B4%EB%A1%9C%EC%A0%80">[React] useStateì˜ ë™ì‘ ì›ë¦¬ì™€ í´ë¡œì €</a>
>
> <a href="https://ko.legacy.reactjs.org/docs/hooks-rules.html">Hookì˜ ê·œì¹™</a>
> 
> <a href="https://jaehan.blog/posts/react/useState-%EB%8F%99%EC%9E%91-%EC%9B%90%EB%A6%AC%EC%99%80-%ED%81%B4%EB%A1%9C%EC%A0%80">useState ë™ì‘ ì›ë¦¬ì™€ í´ë¡œì €</a>
> 
> <a href="https://sandwe.tistory.com/m/72">useState Hook, setStateê°€ ì¸ìë¡œ í•¨ìˆ˜ë¥¼ ì „ë‹¬ë°›ëŠ” ì´ìœ ?</a>