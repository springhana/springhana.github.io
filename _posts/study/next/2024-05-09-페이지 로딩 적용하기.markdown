---
layout: post
related_posts:
  - /study/next/2024-03-17-Data Fetching.markdown
title: í˜ì´ì§€ ë¡œë”© ì ìš©í•˜ê¸°
categories:
  - study
  - next
image: /assets/img/next/Next.png
permalink: '/:categories/:year/:month/:day/:title/'
description: >
  Next.jsì˜ í˜ì´ì§€ ë¡œë”© ì ìš©í•˜ê¸° 
---

* toc
{:toc}

Next.jsì„ ì‚¬ìš©í•˜ë©´ì„œ ë‹¤ë¥¸ í˜ì´ì§€ë¡œ ì´ë™ì„ í•  ë•Œ ê°€ë§Œíˆ ë©ˆì¶°ìˆëŠ” í™”ë©´ì„ ë³¸ ì ì´ ìˆì„ ê²ƒì…ë‹ˆë‹¤.

íŠ¹íˆ ì²˜ìŒìœ¼ë¡œ í˜ì´ì§€ë¡œ ì´ë™í•  ë•Œ ë§ì´ ë³´ì…ë‹ˆë‹¤.

# ë©ˆì¶°ìˆëŠ” í™”ë©´

Next.jsëŠ” `SSR` (ì„œë²„ ì‚¬ì´ë“œ ë Œë”ë§)ì´ë‹¤. í˜ì´ì§€ë¡œ ì „í™˜ í•´ë³´ë©´ `getServerSideProps`ê°€ í˜¸ì¶œ ë˜ëŠ”ê±¸ ì•Œ ìˆ˜ ìˆìŠµë‹ˆë‹¤.

ì´ë™ì„ í•  ë–¼ `next/link` ë˜ëŠ” `next/router`ë¥¼ ì´ìš©í•˜ëŠ”ë° í˜ì´ì§€ë¥¼ ì „í™˜í•˜ë©´ `SSR`ì´ ì ìš©ëœ í˜ì´ì§€ëŠ” ì„œë²„ì—ì„œ `getServerSideProps`ë¥¼ í˜¸ì¶œí•˜ê³  ë°ì´í„°ë¥¼ `JSON`ìœ¼ë¡œ ë°˜í™˜í•©ë‹ˆë‹¤.

`getServerSideProps`ëŠ” ë¸Œë¼ìš°ì €ê°€ ì•„ë‹Œ ì„œë²„ì—ì„œ í˜¸ì¶œí•˜ê¸° ë•Œë¬¸ì— ì‘ë‹µì´ ì˜¬ ë•Œê¹Œì§€ í˜ì´ì§€ê°€ ë©ˆì¶° ìˆëŠ”ë“¯í•œ ëŠë‚Œì„ ë°›ê²Œ ë©ë‹ˆë‹¤.

ì´ëŸ° ê²½ìš°ì—ëŠ” `dynamic`ìœ¼ë¡œ `CSR`ë¡œ ë³€ê²½ì„ í•´ì£¼ë©´ ë©ë‹ˆë‹¤.

> ë§Œì•½ í•´ì¤˜ë„ ì†ë„ê°€ ë³„ ì°¨ì´ê°€ ì•ˆ ë‚  ê²½ìš° ë¡œë”© ì²˜ë¦¬ë¥¼ í•´ì¤˜ë„ ê´œì°®ë‹¤ê³  ìƒê°í•´ì„œ ë‚˜ëŠ” ë¡œë”© ì²˜ë¦¬ë¥¼ í•´ì¤¬ë‹¤. (ì†ë„ê°€ ê·¸ë ‡ê²Œ ëŠë¦¬ì§€ëŠ” ì•Šì•˜ë‹¤.)

# ë¡œë”© ì ìš©í•˜ê¸°

ë¼ìš°íŒ…ì— ì´ë²¤íŠ¸ë¥¼ ì ìš©ì‹œì¼œì¤˜ì„œ ë¡œë”©ì„ ì²˜ë¦¬í•˜ëŠ” ë°©ë²•ì…ë‹ˆë‹¤.

- ë¼ìš°íŒ…ìœ¼ë¡œ ì´ë²¤íŠ¸ë¥¼ ì ìš©í•´ ì¤„ ë¿ì´ê³  ë¼ìš°íŒ… ì†ë„ê°€ ëŠë¦¬ë©´ ì½”ë“œ ë¶„í• ì„ í•´ì¤˜ì•¼ í•©ë‹ˆë‹¤.

`_app.tsx`ì— ì ìš© ì‹œì¼œì¤€ë‹¤.

```tsx
Â const [loading, setLoading] = useState(false);

Â  useEffect(() => {
Â  Â  let timer: NodeJS.Timeout | undefined;

Â  Â  const start = () => {
Â  Â  Â  setLoading(true);
Â  Â  };

Â  Â  const end = () => {
Â  Â  Â  setLoading(false);
Â  Â  };

Â  Â  Router.events.on('routeChangeStart', start);
Â  Â  Router.events.on('routeChangeComplete', end);
Â  Â  Router.events.on('routeChangeError', end);

Â  Â  return () => {
Â  Â  Â  Router.events.off('routeChangeStart', start);
Â  Â  Â  Router.events.off('routeChangeComplete', end);
Â  Â  Â  Router.events.off('routeChangeError', end);
Â  Â  Â  clearTimeout(timer);
Â  Â  };
Â  }, []);
```

`routeChangeStart(url, { shallow })`Â : ë¼ìš°íŠ¸ê°€ ë³€ê²½ë˜ê¸° ì‹œì‘í• ë•Œ íŠ¸ë¦¬ê±°ë©ë‹ˆë‹¤.

`routeChangeComplete(url, { shallow })`Â : ë¼ìš°íŠ¸ê°€ ì™„ì „íˆ ë³€ê²½ë˜ì—ˆì„ ë•Œ íŠ¸ë¦¬ê±°ë©ë‹ˆë‹¤.

`routeChangeError(err, url, { shallow })`Â : ë¼ìš°íŠ¸ ë³€ê²½ ì¤‘ì— ì—ëŸ¬ê°€ ë°œìƒí–ˆê±°ë‚˜, ì·¨ì†Œë˜ì—ˆì„ ë•Œ íŠ¸ë¦¬ê±°ë©ë‹ˆë‹¤.

ì ìš©ì„ ì‹œì¼œì£¼ëŠ” ê²ƒì€ ë‹¤ë¥¸ ë¡œë”©ì„ ì²˜ë¦¬í•˜ëŠ” ê²ƒ ê³¼ ê°™ìŠµë‹ˆë‹¤.

```tsx
return (
	{loading ? (
		<Loading />
	) : (
		<Component {...pageProps} />
	)}
)
```

> ì € ê°™ì€ ê²½ìš°ëŠ” ë¡œë”© ì»´í¬ë„ŒíŠ¸ë¥¼ ë”°ë¡œ ë§Œë“¤ì–´ì„œ ì ìš© ì‹œì¼œì¤¬ìŠµë‹ˆë‹¤.

ì´ì œ ì´ë™í•  ê²½ìš°ì—ëŠ” ë¡œë”© í˜ì´ì§€ë¥¼ í™•ì¸í•  ìˆ˜ ìˆì„ ê²ƒì´ë‹¤.

<img src="/assets/img/next/BeeSpace ë¡œë”©.gif" />

# ë¡œë”© ì‹œê°„ ì¶”ê°€

ë¡œë”©ì„ ì¶”ê°€ì‹œì¼œ ì£¼ëŠ” ê²ƒê¹Œì§€ ì¢‹ì•˜ìŠµë‹ˆë‹¤. í•˜ì§€ë§Œ í˜ì´ì§€ë¥¼ ì´ë™í•  ë•Œë§ˆë‹¤ ë¡œë”© í˜ì´ì§€ê°€ ì ìš©ëìŠµë‹ˆë‹¤.

ì²« í˜ì´ì§€ ì†ë„ë§Œ ëŠë¦¬ê³  ë‹¤ìŒì—ëŠ” ë¹ ë¥¸ ì†ë„ë¡œ ì´ë™í•´ë²„ë ¤ë„ ë¡œë”© í˜ì´ì§€ê°€ ì ìš©ëìŠµë‹ˆë‹¤. ì´ëŸ´ ê²½ìš° ì˜¤íˆë ¤ ë…ì´ ëìŠµë‹ˆë‹¤.

ì´ëŸ´ ë•Œë¥¼ ëŒ€ë¹„í•´ì„œ ì‹œê°„ì„ ì¶”ê°€í–ˆìŠµë‹ˆë‹¤.

```tsx
let timer: NodeJS.Timeout | undefined;

const start = () => {
	// ì‹œì‘ ì‹œ íƒ€ì´ë¨¸ ì„¤ì •
	timer = setTimeout(() => {
		setLoading(true);
	}, 500); // 0.5ì´ˆ í›„ì— ë¡œë”© ìƒíƒœë¥¼ ì„¤ì •
};

const end = () => {
	// ëë‚˜ë©´ íƒ€ì´ë¨¸ í´ë¦¬ì–´
	clearTimeout(timer);
	setLoading(false);
};
```

ì‹œì‘í•  ê²½ìš° `timer`ë¥¼ ì¶”ê°€ì‹œì¼œì„œ 0.5ì´ˆê°€ ì´ˆê³¼í•  ê²½ìš° ë¡œë”© ìƒíƒœë¥¼ ì„¤ì •í•´ì£¼ê²Œ í–ˆìŠµë‹ˆë‹¤.

ëë‚˜ë©´ íƒ€ì´ë¨¸ë„ ê°™ì´ ëë‚´ì¤¬ìŠµë‹ˆë‹¤.

ì´ëŸ´ê²Œ í•´ì£¼ë©´ ë¹ ë¥¸ ì†ë„ë¡œ í˜ì´ì§€ë¥¼ í•´ë²„ë¦¬ë©´ ë¡œë”©ì„ ìƒëµí•˜ê²Œ ë©ë‹ˆë‹¤.

---

ì½”ë“œ ë¶„í• ì„ í•´ë„ ì†ë„ ì°¨ì´ê°€ ì•ˆë‚˜ì§€ë§Œ ì²« í˜ì´ì§€ ì´ë™ì—ì„œ ëŠë¦° ì†ë„ë¥¼ ê°€ì§„ë‹¤ë©´ ìœ„ì˜ ë°©ë²•ì„ ì ìš©í•´ì¤˜ë„ ë‚˜ì˜ì§€ ì•Šì„ ê²ƒ ê°™ìŠµë‹ˆë‹¤.

# ì°¸ê³ 

> <a href="https://velog.io/@namtaehyun/Next.js-%EC%A0%9C%EB%8C%80%EB%A1%9C-%EC%95%8C%EA%B3%A0-%EC%82%AC%EC%9A%A9%ED%95%98%EA%B8%B0-%EC%A0%81%EC%A0%88%ED%95%98%EC%A7%80-%EB%AA%BB%ED%95%9C-SSR">Next.js ì œëŒ€ë¡œ ì•Œê³  ì‚¬ìš©í•˜ê¸°ğŸ§ ì ì ˆí•˜ì§€ ëª»í•œ SSR</a>
>
> <a href="https://hanbbistory.tistory.com/87">NextJsì—ì„œì˜ ë¡œë”© ì²˜ë¦¬</a>

